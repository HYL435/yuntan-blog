server:
  port: 8081
spring:
  application:
    name: blog-user-service
  profiles:
    active: dev  # 激活的配置文件
  datasource: # 数据源配置
    url: jdbc:mysql://${yuntan.db.host}:${yuntan.db.port}/blog-user?useUnicode=true&characterEncoding=UTF-8&autoReconnect=true&serverTimezone=Asia/Shanghai
    driver-class-name: com.mysql.cj.jdbc.Driver
    username: root
    password: ${yuntan.db.pw}
  cloud:
    nacos:
      server-addr: 127.0.0.1:8848
mybatis-plus:
  # 配置项（核心是修复语法错误 + 补全必要配置）
  configuration:
    # 枚举类型处理器（自动转换枚举类型，无需手动指定）
    default-enum-type-handler: com.baomidou.mybatisplus.core.handlers.MybatisEnumTypeHandler
    # 补充常用配置：开启驼峰命名转换（数据库下划线→Java驼峰）
    map-underscore-to-camel-case: true
    # 补充：打印SQL日志（开发环境用，生产关闭）
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
  global-config:
    db-config:
      # 更新策略：只更新非NULL字段（避免覆盖已有值）
      update-strategy: not_null
      # 主键生成策略：雪花ID
      id-type: assign_id
    # 补充：关闭Banner（启动时不打印MyBatis-Plus标志）
    banner: false
logging:
  # 日志级别
  level:
    com.yuntan: debug  # debug级别适合开发环境
    root: info         # 全局默认日志级别（避免所有日志都输出debug）
  # 日志格式（包含时间、线程、类名等关键信息）
  pattern:
    console: "%d{HH:mm:ss:SSS} [%thread] %-5level %logger{50} - %msg%n"  # 控制台输出格式
    file: "%d{yyyy-MM-dd HH:mm:ss:SSS} [%thread] %-5level %logger{50} - %msg%n"    # 文件输出格式
    dateformat: HH:mm:ss:SSS
  # 日志文件配置（修复路径格式，补充滚动策略避免日志文件过大）
  file:
    path: logs/${spring.application.name}
  logback:
    rollingpolicy:
      max-file-size: 100MB  # 单个日志文件最大100MB
      max-history: 7        # 日志文件保留7天
      total-size-cap: 1GB   # 日志总大小上限1GB
# Knife4j & Swagger 基础配置
knife4j:
  enable: true  # 开启Knife4j增强
  openapi:
    api-rule: package
    api-rule-resources:
      - com.yuntan.blog.user.controller.front  # 你的前台控制器包
      - com.yuntan.blog.user.controller.admin  # 你的后台控制器包
springdoc:
  api-docs:
    path: /v3/api-docs
    enabled: true
  swagger-ui:
    path: /swagger-ui.html
    enable: true  # 修正：SpringDoc的开关是enable，不是enabled
    tags-sorter: alpha
    operations-sorter: alpha
# 自定义文档元数据 (供 Java 配置类读取)
api:
  info:
    title: 云坛博客 API 文档
    description: 基于 Spring Boot 3 + SpringDoc + Knife4j 的接口文档
    version: v1.0.0
    contact-name: 苜玥
    contact-email: 2929028544@qq.com
    contact-url: https://www.yuntan.com
# JWT认证配置（极简版：仅登录认证，无角色鉴权）
yuntan:
  # JWT令牌核心配置
  jwt:
    location: classpath:yuntan.jks       # JKS密钥文件路径（resources目录下）
    alias: yuntan                        # JKS密钥库别名
    password: yuntan@766498              # JKS密钥库密码（生产环境用环境变量）
    tokenTTL: 3h                         # 令牌有效期（3小时）